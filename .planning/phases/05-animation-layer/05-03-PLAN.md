---
phase: 05-animation-layer
plan: 03
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - src/components/animation/ScrollReveal.tsx
  - src/components/animation/StaggerContainer.tsx
  - src/components/trending/TrendingPage.tsx
  - src/components/discovery/DiscoveryPage.tsx
  - src/components/dinner-time/DinnerTimePage.tsx
  - src/components/free-movies/FreeMoviesPage.tsx
autonomous: true
requirements: [ANIM-02]

must_haves:
  truths:
    - "Movie cards and sections reveal with staggered animations as user scrolls into view"
    - "First appearance uses full animation (60-100px travel, 0.6s), re-entries use shorter/subtler animation"
    - "Horizontal lists slide in as a group from one side"
    - "Trending page cards stagger their entrance in a cascade, not all at once"
  artifacts:
    - path: "src/components/animation/ScrollReveal.tsx"
      provides: "Reusable whileInView wrapper with replay support and reduced re-entry duration"
      exports: ["ScrollReveal"]
    - path: "src/components/animation/StaggerContainer.tsx"
      provides: "Parent container that staggers children's entrance animations"
      exports: ["StaggerContainer", "StaggerItem"]
    - path: "src/components/trending/TrendingPage.tsx"
      provides: "Trending page with staggered card reveals on scroll"
      contains: "StaggerContainer"
  key_links:
    - from: "src/components/trending/TrendingPage.tsx"
      to: "src/components/animation/StaggerContainer.tsx"
      via: "wraps movie card grid in StaggerContainer"
      pattern: "StaggerContainer"
    - from: "src/components/discovery/DiscoveryPage.tsx"
      to: "src/components/animation/ScrollReveal.tsx"
      via: "wraps below-fold similar movies section"
      pattern: "ScrollReveal"
    - from: "src/components/dinner-time/DinnerTimePage.tsx"
      to: "src/components/animation/StaggerContainer.tsx"
      via: "wraps service selector buttons in StaggerContainer"
      pattern: "StaggerContainer"
---

<objective>
Create reusable scroll-triggered reveal components (ScrollReveal and StaggerContainer) and integrate them into all content pages for staggered entrance animations on scroll.

Purpose: ANIM-02 (scroll-triggered reveals) is the second most impactful animation — it transforms static pages into living experiences where content "arrives" as the user explores. The reusable wrapper approach means consistent choreography across all pages.

Output: ScrollReveal component with replay-aware animation, StaggerContainer for card grids, integration into Trending, Discovery, DinnerTime, and FreeMovies pages.
</objective>

<execution_context>
@/Users/kohulanrajan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kohulanrajan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-animation-layer/05-RESEARCH.md
@.planning/phases/05-animation-layer/05-CONTEXT.md
@.planning/phases/05-animation-layer/05-01-SUMMARY.md
@src/components/trending/TrendingPage.tsx
@src/components/discovery/DiscoveryPage.tsx
@src/components/dinner-time/DinnerTimePage.tsx
@src/components/free-movies/FreeMoviesPage.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ScrollReveal and StaggerContainer animation components</name>
  <files>
    src/components/animation/ScrollReveal.tsx
    src/components/animation/StaggerContainer.tsx
  </files>
  <action>
    1. Create `src/components/animation/ScrollReveal.tsx`:
       - Props: `children`, `className?`, `travel?: number` (default 80), `delay?: number` (default 0), `once?: boolean` (default false — replays by default per user decision)
       - Internal state: `hasAnimated` (boolean, starts false) — tracks whether the element has been seen before
       - First appearance: full animation with `duration: 0.6` and full `travel` distance (60-100px range)
       - Re-entry (hasAnimated=true): shorter `duration: 0.3` and reduced travel (`travel * 0.4`) — per decision "replay on scroll-back with shorter duration"
       - Use `whileInView` with `viewport={{ amount: 0.2 }}` — element must be 20% visible before triggering
       - Variants: `hidden: { opacity: 0, y: actualTravel }` and `visible: { opacity: 1, y: 0, transition: { duration, delay, ease: [0.25, 0.1, 0.25, 1] } }`
       - Set `onAnimationComplete={() => setHasAnimated(true)}` on the motion.div
       - Follow the code example in 05-RESEARCH.md Pattern 2 (ScrollReveal), adjusted for the parameters above

    2. Create `src/components/animation/StaggerContainer.tsx`:
       - Export `StaggerContainer` component: a `motion.div` with `whileInView="visible"` and `initial="hidden"` and `viewport={{ amount: 0.15 }}`
       - Props: `children`, `className?`, `stagger?: number` (default 0.08), `direction?: 'up' | 'left' | 'right'` (default 'up')
       - Container variants: `hidden: {}`, `visible: { transition: { staggerChildren: stagger, delayChildren: 0.1 } }` — use `custom` prop for dynamic stagger value
       - Export `StaggerItem` component: a `motion.div` that reads parent variants. Props: `children`, `className?`, `direction?: 'up' | 'left' | 'right'`
         - Direction variants map: `up: { hidden: { opacity: 0, y: 40 }, visible: { opacity: 1, y: 0 } }`, `left: { hidden: { opacity: 0, x: 60 }, visible: { opacity: 1, x: 0 } }`, `right: { hidden: { opacity: 0, x: -60 }, visible: { opacity: 1, x: 0 } }`
         - Use `type: 'spring', stiffness: 300, damping: 24` for visible transition
       - `StaggerItem` must use `variants` prop (not `initial`/`animate`) so it inherits timing from the parent `StaggerContainer`

    Follow the code examples in 05-RESEARCH.md Pattern 3 (Staggered Children Container). The key insight: StaggerItem does NOT set its own `initial`/`whileInView` — it relies on the parent StaggerContainer's variants propagation.
  </action>
  <verify>
    - `npm run build` succeeds
    - `grep "whileInView" src/components/animation/ScrollReveal.tsx` confirms viewport trigger
    - `grep "staggerChildren" src/components/animation/StaggerContainer.tsx` confirms stagger setup
    - `grep "StaggerItem" src/components/animation/StaggerContainer.tsx` confirms child component exported
  </verify>
  <done>ScrollReveal component animates elements on viewport entry with replay support (full animation first time, shorter on re-entry). StaggerContainer and StaggerItem cascade children's entrances with configurable direction and stagger delay.</done>
</task>

<task type="auto">
  <name>Task 2: Integrate scroll reveals into all content pages</name>
  <files>
    src/components/trending/TrendingPage.tsx
    src/components/discovery/DiscoveryPage.tsx
    src/components/dinner-time/DinnerTimePage.tsx
    src/components/free-movies/FreeMoviesPage.tsx
  </files>
  <action>
    **TrendingPage.tsx** — Staggered card reveals:
    - Import `StaggerContainer` and `StaggerItem` from `@/components/animation/StaggerContainer`
    - Wrap the movie card grid/scroll container (the `<div>` with `role="list"`) in a `<StaggerContainer stagger={0.05} direction="up">`. Keep the existing className on the StaggerContainer (pass it through)
    - Wrap each movie card `<button>` in a `<StaggerItem>`. The StaggerItem inherits the stagger timing from the parent. Keep the button's existing className and event handlers intact inside the StaggerItem
    - For mobile horizontal scroll: the StaggerContainer still works because `whileInView` triggers per-item when scrolling horizontally
    - Performance consideration per research: `stagger: 0.05` means only 3-4 cards animate simultaneously, avoiding frame drops

    **DiscoveryPage.tsx** — Scroll reveal on below-fold content:
    - Import `ScrollReveal` from `@/components/animation/ScrollReveal`
    - Wrap the "You might also like" similar movies section (the `<div className="relative z-10 bg-clay-base">` containing similar movies) in `<ScrollReveal travel={60}>`. This section appears below the fold and should animate in when scrolled to
    - For the horizontal similar movies row: wrap in a `<StaggerContainer direction="left" stagger={0.06}>` and each similar movie button in `<StaggerItem direction="left">` — per decision "Horizontal lists slide in as a group from one side"

    **DinnerTimePage.tsx** — Scroll reveal on service selector and content:
    - Import `ScrollReveal` from `@/components/animation/ScrollReveal`
    - Import `StaggerContainer` and `StaggerItem` from `@/components/animation/StaggerContainer`
    - Wrap the page header (`<div>` with h1 "Dinner Time") in `<ScrollReveal travel={40} once>` — header only needs to animate once since it's near the top
    - Wrap the service selector buttons group in `<StaggerContainer direction="up" stagger={0.1}>` and each service button in `<StaggerItem>` — the 3 service buttons stagger their entrance

    **FreeMoviesPage.tsx** — Scroll reveal on page header:
    - Import `ScrollReveal` from `@/components/animation/ScrollReveal`
    - Wrap the page header section in `<ScrollReveal travel={40} once>` — simple reveal for the "Free Movies" heading area

    General rules:
    - Do NOT add scroll reveals to the hero MovieHero section on any page — that content is above the fold and already visible, scroll reveal would just add delay
    - Only add reveals to content that starts off-screen or below the fold
    - Keep all existing className, role, and aria attributes intact — animation wrappers are additive
  </action>
  <verify>
    - `npm run build` succeeds
    - `grep "StaggerContainer" src/components/trending/TrendingPage.tsx` confirms stagger integration
    - `grep "ScrollReveal" src/components/discovery/DiscoveryPage.tsx` confirms similar movies reveal
    - `grep "StaggerContainer" src/components/dinner-time/DinnerTimePage.tsx` confirms service button stagger
    - `grep "ScrollReveal" src/components/free-movies/FreeMoviesPage.tsx` confirms header reveal
  </verify>
  <done>All content pages have scroll-triggered reveals: Trending cards stagger on scroll, Discovery similar movies slide in from the left, DinnerTime service buttons stagger entrance, FreeMovies header fades in. Below-fold content animates on viewport entry with replay support.</done>
</task>

</tasks>

<verification>
- `npm run build` passes cleanly
- Scroll down on Trending page: cards cascade into view with stagger
- Scroll to similar movies on Discovery: section slides up, individual posters slide in from left
- Service buttons on DinnerTime stagger their entrance
- Fast scrolling does not cause visual glitches (viewport.amount threshold prevents flicker)
</verification>

<success_criteria>
- ScrollReveal and StaggerContainer are reusable components in src/components/animation/
- Trending page movie cards stagger with 50ms delay between each
- Discovery similar movies section reveals on scroll with horizontal slide-in
- DinnerTime service buttons stagger entrance
- Re-entry animations are shorter/subtler than first appearance
- All reveals use viewport threshold to prevent rapid-fire triggers
</success_criteria>

<output>
After completion, create `.planning/phases/05-animation-layer/05-03-SUMMARY.md`
</output>
